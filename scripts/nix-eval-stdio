#!/usr/bin/env bash

function fail {
    echo "FAIL: $1" >> /dev/stderr
    exit 1
}

function mkTrue {
  cat <<'EOF' | nix-shell -p 'haskellPackages.ghcWithPackages (h: [ h.nix-eval ])' --run runhaskell
import Language.Eval

main = do Just x <- eval (raw "show" $$ raw "True")
          putStrLn x
EOF
}

RESULT=$(mkTrue)

[[ "x$RESULT" = "xTrue" ]] || fail "Wrong value"
